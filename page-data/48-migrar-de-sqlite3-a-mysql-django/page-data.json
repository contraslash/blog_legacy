{"componentChunkName":"component---src-templates-blog-post-js","path":"/48-migrar-de-sqlite3-a-mysql-django/","result":{"data":{"site":{"siteMetadata":{"title":"Blog de Contraslash (Legacy)"}},"markdownRemark":{"id":"4949a858-630e-5752-b741-7e96aa01bdf8","excerpt":"Migrar de sqlite3 a MySQL Django Las migraciones de base de datos, independiente de la razón, siempre son fastiosas Si aún no está instalado MySQL, instalarlo…","html":"<h1>Migrar de sqlite3 a MySQL Django</h1>\n<p>Las migraciones de base de datos, independiente de la razón, siempre son fastiosas</p>\n<p>Si aún no está instalado MySQL, instalarlo </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo apt-get install mysql-server</code></pre></div>\n<p>También necesitamos Python-dev</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo apt-get install python-dev</code></pre></div>\n<p>Instalamos dependencias requeridas en el Sistema operativo</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo apt-get install libmysqlclient-dev\nsudo pip install MySQL-python</code></pre></div>\n<p>Insalamos las dependencias en nuestro virtualenv</p>\n<p><code class=\"language-text\">pip install MySQL-python</code></p>\n<p>Existen dos aproximaciones a al dump data: especificando las aplicaciones que queremos migrar\n<code class=\"language-text\">manage.py dumpdata --natural-foreign auth.User  &gt; initial_data.json</code></p>\n<p>y excluyendo</p>\n<p><code class=\"language-text\">./manage.py dumpdata --exclude=contenttypes --exclude=auth.Permission &gt; initial_data.json</code></p>\n<p>Altamente recomiendo usar este último, pues evita problemas de llaves foraneas.</p>\n<p>Luego podemos modificar nuestro archivo <em>settings.py</em> actualizando nuestra configuración de bases de datos\nde:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DATABASES = {\n    &#39;default&#39;: {\n        &#39;ENGINE&#39;: &#39;django.db.backends.sqlite3&#39;,\n        &#39;NAME&#39;: os.path.join(BASE_DIR, &#39;db.sqlite3&#39;),\n    }\n}</code></pre></div>\n<p>a:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DATABASES = {\n    &#39;default&#39;: {\n        &#39;ENGINE&#39;: &#39;django.db.backends.mysql&#39;,\n        &#39;OPTIONS&#39;: {\n            &#39;read_default_file&#39;: os.path.join(BASE_DIR,  &#39;database.cnf&#39;),\n        },\n    }\n}</code></pre></div>\n<p>donde <em>database.cnf</em> es algo como</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[client]\ndatabase = database\nuser = user_database\npassword = password_database\ndefault-character-set = utf8</code></pre></div>\n<p>Ahora es importante migrar la base de datos\n<code class=\"language-text\">./manage.py migrate</code></p>\n<p>Luego podemos importar datos.</p>\n<p>Para importar los datos.</p>\n<p><code class=\"language-text\">python manage.py loaddata initial_data.json</code> </p>\n<p>Cabe aclarar que pueden existir conflictos, específicamete con llaves foraneas, es posible que realmente el problema sea de integridad de la base de datos. Igual vale la pena verificar que los datos sean correctos</p>\n<p>Espero que esto les haya sido útil o al menos les haya dado algo de luz</p>\n<p>PD: Para extraer datos directamente de sqlite, uso el siguiente comando:</p>\n<p><code class=\"language-text\">sqlite3 db.sqlite3 &quot;.dump &#39;tabla1&#39; &#39;tabla2&#39;&quot; | grep INSERT &gt; dump_tablas.sql</code></p>","frontmatter":{"title":"Migrar de sqlite3 a MySQL Django","date":"January 29, 2016","description":""}}},"pageContext":{"slug":"/48-migrar-de-sqlite3-a-mysql-django/","previous":{"fields":{"slug":"/49-forms-inline/"},"frontmatter":{"title":"Forms Inline"}},"next":{"fields":{"slug":"/47-a-proposito-de-errores-de-novatos-con-apache-y-dja/"},"frontmatter":{"title":"A propósito de errores de novatos con Apache y Django"}}}}}