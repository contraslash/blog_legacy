{"componentChunkName":"component---src-templates-blog-post-js","path":"/186-almacenar-archivos-en-s3-desde-django/","result":{"data":{"site":{"siteMetadata":{"title":"Blog de Contraslash (Legacy)"}},"markdownRemark":{"id":"aaf06a18-528f-595a-a349-3dca34024c6f","excerpt":"Almacenar Archivos en S3 desde Django A pesar de que ya existe un post similar, hago necesario escribir la versión condensada para alojar archivos en S3 usando…","html":"<h1>Almacenar Archivos en S3 desde Django</h1>\n<p>A pesar de que <a href=\"http://blog.contraslash.com/archivos-estaticos-en-s3-con-django/\">ya existe un post similar</a>, hago necesario escribir la versión condensada para alojar archivos en S3 usando Django.</p>\n<p>TL;DR</p>\n<ol>\n<li>Cree un bucket en S3</li>\n<li>Cree un usuario IAM</li>\n<li>Pegue esto en la politica del bucket modificando los valores correspondientes</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  {\n      &quot;Statement&quot;: [\n          {\n            &quot;Sid&quot;:&quot;PublicReadForGetBucketObjects&quot;,\n            &quot;Effect&quot;:&quot;Allow&quot;,\n            &quot;Principal&quot;: {\n                  &quot;AWS&quot;: &quot;*&quot;\n               },\n            &quot;Action&quot;:[&quot;s3:GetObject&quot;],\n            &quot;Resource&quot;:[&quot;arn:aws:s3:::&lt;BUCKET_NAME&gt;/*&quot;\n            ]\n          },\n          {\n              &quot;Action&quot;: &quot;s3:*&quot;,\n              &quot;Effect&quot;: &quot;Allow&quot;,\n              &quot;Resource&quot;: [\n                  &quot;arn:aws:s3:::&lt;BUCKET_NAME&gt;&quot;,\n                  &quot;arn:aws:s3:::&lt;BUCKET_NAME&gt;/*&quot;\n              ],\n              &quot;Principal&quot;: {\n                  &quot;AWS&quot;: [\n                      &quot;&lt;USER_ARN&gt;&quot;\n                  ]\n              }\n          }\n      ]\n  }</code></pre></div>\n<ol>\n<li>Instale</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pip install django-storages boto3</code></pre></div>\n<ol>\n<li>\n<p>Cree un archivo en la carpeta del proyecto, al lado de <code class=\"language-text\">settings.py</code> llamada <code class=\"language-text\">custom_storages.py</code> y añadale este contenido:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">from django.conf import LazySettings\nfrom storages.backends.s3boto3 import S3Boto3Storage\n\nsettings = LazySettings()\n\n\nclass MediaStorage(S3Boto3Storage):\n    location = &quot;&quot;\n    bucket_name = settings.AWS_MEDIA_STORAGE_BUCKET_NAME\n    access_key = settings.AWS_MEDIA_ACCESS_KEY_ID\n    secret_key = settings.AWS_MEDIA_SECRET_ACCESS_KEY\n    region_name = settings.AWS_MEDIA_S3_REGION_NAME\n    custom_domain = settings.AWS_MEDIA_S3_CUSTOM_DOMAIN</code></pre></div>\n</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1. Al final del archivo de `settings.py` incluya esto reemplazando por los valores correctos</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">AWS_MEDIA_STORAGE_BUCKET_NAME = &#39;&lt;BUCKET_NAME&gt;&#39;\nAWS_MEDIA_S3_REGION_NAME = &#39;&lt;AWS_REGION&gt;&#39;\nAWS_MEDIA_ACCESS_KEY_ID = &#39;&lt;SECRET_IAM_KEY_ID&gt;&#39;\nAWS_MEDIA_SECRET_ACCESS_KEY = &#39;&lt;SECRET_IAM_ACCESS_ID&gt;&#39;\nAWS_MEDIA_S3_CUSTOM_DOMAIN = &#39;%s.s3.amazonaws.com&#39; % AWS\nDEFAULT_FILE_STORAGE = &#39;&lt;PROJECT_NAME&gt;.custom_storages.MediaStorage&#39;</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"></code></pre></div>","frontmatter":{"title":"Almacenar Archivos en S3 desde Django","date":"November 30, 2017","description":"Como guardar archivos en S3 usando Django"}}},"pageContext":{"slug":"/186-almacenar-archivos-en-s3-desde-django/","previous":{"fields":{"slug":"/185-vincular-membership-a-proyecto-taiga/"},"frontmatter":{"title":"Vincular Membership a Proyecto Taiga"}},"next":{"fields":{"slug":"/187-pain-is-my-greatest-enemy/"},"frontmatter":{"title":"Pain is my greatest enemy"}}}}}